<script>
        // --- 1. HIGH SECURITY SCRIPTS (Anti-Theft) ---
        document.onkeydown = function(e) {
            if(document.body.classList.contains('admin-active')) return true; 
            if(event.keyCode == 123) return false;
            if(e.ctrlKey && e.shiftKey && (e.keyCode == 'I'.charCodeAt(0) || e.keyCode == 'C'.charCodeAt(0) || e.keyCode == 'J'.charCodeAt(0))) return false;
            if(e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)) return false;
            if(e.ctrlKey && e.keyCode == 'S'.charCodeAt(0)) return false;
            if(e.ctrlKey && e.keyCode == 'P'.charCodeAt(0)) return false;
            if(e.ctrlKey && e.keyCode == 'C'.charCodeAt(0)) return false;
        }

        // --- 2. SMART VIEW COUNTER LOGIC ---
        function getViewCount(index) {
            // Unique ID for each article in browser storage
            let storageKey = 'zaad_article_view_' + index;
            
            // Check if we already have a count for this article
            let currentViews = localStorage.getItem(storageKey);

            if (!currentViews) {
                // If new, generate a realistic random number between 200 and 2000
                currentViews = Math.floor(Math.random() * (2000 - 200 + 1)) + 200;
            } else {
                // If exists, convert to number
                currentViews = parseInt(currentViews);
            }

            // Increment view by 1 (Simulating a new visit)
            // We add a small chance to jump by 2-5 views to look like "live" traffic
            let jump = Math.random() < 0.3 ? Math.floor(Math.random() * 5) + 1 : 1; 
            currentViews += jump;

            // Save back to storage
            localStorage.setItem(storageKey, currentViews);
            
            return currentViews;
        }

        // --- 3. GENERATE ARTICLES ---
        const articlesData = [
            { cat: "ޓެކްނޮލޮޖީ", title: "އޭ.އައި ގެ ކުރިމަގު", img: "https://images.unsplash.com/photo-1677442136019-21780ecad995?w=500", date: "21 Dec 2025", author: "އެޑްމިން" },
            { cat: "ތަޢުލީމް", title: "އޮންލައިންކޮށް ކިޔެވުމުގެ ފައިދާ", img: "https://images.unsplash.com/photo-1501504905252-473c47e087f8?w=500", date: "20 Dec 2025", author: "ޒާދް" },
            { cat: "ދިރާސާ", title: "ކުދިންގެ ވިސްނުން ތަރައްޤީކުރުން", img: "https://images.unsplash.com/photo-1503676260728-1c00da094a0b?w=500", date: "19 Dec 2025", author: "ރިސާރޗް ޓީމް" },
            { cat: "އިސްލާމީ ތާރީޚް", title: "އަންދަލުސްގެ ރަން ޒަމާން", img: "https://images.unsplash.com/photo-1548625361-12e624c969b8?w=500", date: "18 Dec 2025", author: "ތާރީޚް" },
            { cat: "ސައިންސް", title: "ޖައްވީ ދިރާސާތަކުގެ އާ ހޯދުންތައް", img: "https://images.unsplash.com/photo-1451187580459-43490279c0fa?w=500", date: "17 Dec 2025", author: "ސައިންސް" },
            { cat: "ޓެކްނޮލޮޖީ", title: "ކޯޑިންގ ދަސްކުރުމުގެ މުހިންމުކަން", img: "https://images.unsplash.com/photo-1517694712202-14dd9538aa97?w=500", date: "16 Dec 2025", author: "ޓެކް" },
            { cat: "ތަޢުލީމް", title: "މުދައްރިސުންގެ ދައުރު", img: "https://images.unsplash.com/photo-1524178232363-1fb2b075b655?w=500", date: "15 Dec 2025", author: "އެޑިއުކޭޝަން" },
            { cat: "ސިއްޙަތު", title: "ދުުޅަހެޔޮ ސިއްހަތެއްގައި ހުރުން", img: "https://images.unsplash.com/photo-1571019614242-c5c5dee9f50b?w=500", date: "14 Dec 2025", author: "ހެލްތު" },
            { cat: "އިޤްތިޞާދު", title: "އިސްލާމީ ބޭންކިންގ", img: "https://images.unsplash.com/photo-1611974765270-ca1258634369?w=500", date: "13 Dec 2025", author: "ފައިނޭންސް" },
            { cat: "ދިރާސާ", title: "ކަނޑުގެ ދިރުންތައް", img: "https://images.unsplash.com/photo-1582967788606-a171f1080ca8?w=500", date: "12 Dec 2025", author: "މެރިން" },
            { cat: "އަދަބިއްޔާތު", title: "ދިވެހި ބަހުގެ މުއްސަނދިކަން", img: "https://images.unsplash.com/photo-1455390582262-044cdead277a?w=500", date: "11 Dec 2025", author: "ބަސް" },
            { cat: "ޓެކްނޮލޮޖީ", title: "ރޮބޮޓިކްސްގެ ކުރިއެރުން", img: "https://images.unsplash.com/photo-1485827404703-89b55fcc595e?w=500", date: "10 Dec 2025", author: "ރޮބޮޓިކްސް" },
            { cat: "ތަޢުލީމް", title: "ލައިބްރަރީގެ މުހިންމުކަން", img: "https://images.unsplash.com/photo-1521587760476-6c12a4b040da?w=500", date: "09 Dec 2025", author: "ލައިބްރަރީ" },
            { cat: "އިސްލާމީ ތާރީޚް", title: "މައްކާގެ ފަތަޙަ", img: "https://images.unsplash.com/photo-1537704940854-34d2847be177?w=500", date: "08 Dec 2025", author: "ތާރީޚް" },
            { cat: "ސައިންސް", title: "އިއާދަކުރަނިވި ހަކަތަ", img: "https://images.unsplash.com/photo-1509391366360-2e959784a276?w=500", date: "07 Dec 2025", author: "އެނާޖީ" },
            { cat: "ޓެކްނޮލޮޖީ", title: "ސައިބަރ ސެކިއުރިޓީ", img: "https://images.unsplash.com/photo-1550751827-4bd374c3f58b?w=500", date: "06 Dec 2025", author: "ސެކިއުރިޓީ" },
            { cat: "ތަޢުލީމް", title: "އުނގެނުމުގެ އާ ވައްޓަފާޅި", img: "https://images.unsplash.com/photo-1503676260728-1c00da094a0b?w=500", date: "05 Dec 2025", author: "ޓީޗިންގ" },
            { cat: "ދިރާސާ", title: "މޫސުމީ ބަދަލުތައް", img: "https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?w=500", date: "04 Dec 2025", author: "ކްލައިމެޓް" },
            { cat: "އަދަބިއްޔާތު", title: "ޅެންވެރިކަން", img: "https://images.unsplash.com/photo-1471107340929-a87cd0f5b5f3?w=500", date: "03 Dec 2025", author: "ޅެން" },
            { cat: "އާންމު", title: "ވަގުތުގެ ބޭނުން ހެޔޮގޮތުގައި ހިފުން", img: "https://images.unsplash.com/photo-1501139083538-0139583c61df?w=500", date: "02 Dec 2025", author: "އެޑްމިން" }
        ];

        function generateArticles() {
            const grid = document.getElementById('articleGrid');
            if(grid.innerHTML.trim() === "") {
                articlesData.forEach((item, index) => {
                    // Get Smart Views
                    let views = getViewCount(index);

                    const articleHTML = `
                    <article class="article-card">
                        <button class="delete-btn admin-ui" onclick="removeCard(this)">Delete</button>
                        <div class="card-img-container">
                            <img src="${item.img}" class="card-img" onclick="changeImage(this)">
                        </div>
                        <div class="card-body">
                            <div class="article-tag" contenteditable="false">${item.cat}</div>
                            <h2 class="article-title" contenteditable="false">${item.title}</h2>
                            <div class="meta-row">
                                <div class="meta-item"><i class="far fa-calendar-alt"></i> <span contenteditable="false">${item.date}</span></div>
                                <div class="meta-item"><i class="far fa-eye" style="color:var(--accent)"></i> <strong>${views}</strong></div>
                            </div>
                            <div class="article-summary" contenteditable="false">
                                މިއީ އާޓިކަލްގެ ކުރު ޚުލާސާއެވެ. މިތަނުގައި ލިޔާނީ ކިޔުންތެރިންގެ ޝައުޤުވެރިކަން ދަމައިގަންނަ ފަދަ ކުރު އިބާރާތެކެވެ. (މިބައި ބަދަލުކުރައްވާ)
                            </div>
                            <div class="full-content" contenteditable="false">
                                <p><strong>${item.title}</strong></p>
                                <p>މިއީ މި ލިޔުމުގެ ތަފްޞީލީ ބައެވެ. މިތަނުގައި އާޓިކަލްގެ ފުރިހަމަ މަޢުލޫމާތު ހިމަނުއްވާށެވެ.</p>
                                <p>ލިޔުންތެރިޔާ: ${item.author}<br>ތާރީޚް: ${item.date}</p>
                                <p>މިތަނުގައި އިތުރު ޕެރެގްރާފްތައް ލިޔުއްވާށެވެ. މި ބައި ފެންނާނީ "އިތުރަށް ވިދާޅުވޭ" އަށް ފިތާލުމުންނެވެ.</p>
                            </div>
                            <div class="read-more-btn" onclick="openModal(this)">
                                އިތުރަށް ވިދާޅުވޭ <i class="fas fa-arrow-left"></i>
                            </div>
                        </div>
                    </article>`;
                    grid.insertAdjacentHTML('beforeend', articleHTML);
                });
            }
        }
        window.onload = generateArticles;

        // --- 4. FILTER FUNCTION ---
        function filterArticles() {
            const input = document.getElementById('searchInput');
            const filter = input.value.toLowerCase();
            const grid = document.getElementById('articleGrid');
            const articles = grid.getElementsByClassName('article-card');

            for (let i = 0; i < articles.length; i++) {
                const title = articles[i].querySelector('.article-title').innerText.toLowerCase();
                const tag = articles[i].querySelector('.article-tag').innerText.toLowerCase();
                if (title.indexOf(filter) > -1 || tag.indexOf(filter) > -1) {
                    articles[i].style.display = "";
                } else {
                    articles[i].style.display = "none";
                }
            }
        }

        // --- 5. MODAL LOGIC ---
        function openModal(btn) {
            if(document.body.classList.contains('admin-active')) return; 
            const card = btn.closest('.article-card');
            document.getElementById('modalImg').src = card.querySelector('.card-img').src;
            document.getElementById('modalTitle').innerHTML = card.querySelector('.article-title').innerHTML;
            document.getElementById('modalMeta').innerHTML = card.querySelector('.meta-row').innerHTML;
            document.getElementById('modalText').innerHTML = card.querySelector('.full-content').innerHTML;
            document.getElementById('detailsModal').style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }
        function closeModal() {
            document.getElementById('detailsModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }
        window.onclick = function(e) { if (e.target == document.getElementById('detailsModal')) closeModal(); }

        // --- 6. ADMIN FUNCTIONS ---
        function activateAdmin() {
            if(document.body.classList.contains('admin-active')) return;
            var pass = prompt("Enter Admin Password:");
            if(pass === "admin123") {
                document.body.classList.add('admin-active');
                document.getElementById('adminToolbar').style.display = 'flex';
                document.querySelectorAll('.article-title, .article-summary, .full-content, .article-tag, .meta-item span').forEach(el => el.contentEditable = "true");
                alert("Admin Mode Active!");
            } else {
                alert("Incorrect Password");
            }
        }

        function addNewArticle() {
            const grid = document.getElementById('articleGrid');
            const newCard = document.createElement('article');
            newCard.className = 'article-card';
            
            // Random Views for New Article
            const newViews = Math.floor(Math.random() * 50) + 1; 

            newCard.innerHTML = `
                <button class="delete-btn admin-ui" onclick="removeCard(this)" style="position:absolute; top:10px; left:10px; background:red; color:white; border:none; padding:5px; z-index:10;">Delete</button>
                <div class="card-img-container"><img src="https://via.placeholder.com/600x400" class="card-img" onclick="changeImage(this)"></div>
                <div class="card-body">
                    <div class="article-tag" contenteditable="true">Category</div>
                    <h2 class="article-title" contenteditable="true">New Title</h2>
                    <div class="meta-row">
                        <div class="meta-item"><i class="far fa-calendar-alt"></i> <span contenteditable="true">Date</span></div>
                        <div class="meta-item"><i class="far fa-eye" style="color:var(--accent)"></i> <strong>${newViews}</strong></div>
                    </div>
                    <div class="article-summary" contenteditable="true">Short summary...</div>
                    <div class="full-content" contenteditable="true">Full content...</div>
                    <div class="read-more-btn" onclick="openModal(this)">Read More</div>
                </div>`;
            grid.insertBefore(newCard, grid.firstChild);
        }

        function removeCard(btn) { if(confirm("Delete?")) btn.closest('.article-card').remove(); }
        function changeImage(img) { if(document.body.classList.contains('admin-active')) { let url = prompt("Image URL:", img.src); if(url) img.src = url; } }

        function savePage() {
            let clone = document.documentElement.cloneNode(true);
            clone.querySelector('body').classList.remove('admin-active');
            clone.querySelectorAll('[contenteditable]').forEach(el => el.removeAttribute('contenteditable'));
            clone.querySelector('#adminToolbar').style.display = 'none';
            let script = clone.querySelector('script'); 
            script.innerHTML = script.innerHTML.replace('window.onload = generateArticles;', '// Auto-gen removed');
            let blob = new Blob(["<!DOCTYPE html>\n" + clone.outerHTML], { type: "text/html" });
            let link = document.createElement("a");
            link.href = URL.createObjectURL(blob);
            link.download = `zaad_articles_${new Date().toISOString().split('T')[0]}.html`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    </script>
